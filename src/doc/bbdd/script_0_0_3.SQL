/*
Created: 13/12/2021
Modified: 18/12/2021
Model: gespracti
Database: MySQL 5.7
*/


-- Create tables section -------------------------------------------------

-- Table EMPRESAS

CREATE TABLE `EMPRESAS`
(
  `ID_EMPRESA` Int NOT NULL AUTO_INCREMENT,
  `TIPO_DOCUMENTO` Int NOT NULL,
  `NIF_NIE` Varchar(9) NOT NULL,
  `DENOMINACION_SOCIAL` Varchar(200) NOT NULL,
  `DENOMINACION_COMERCIAL` Varchar(200),
  `TIPO_PERSONA_JURIDICA` Int NOT NULL,
  `DOMICILIO_FISCAL` Varchar(200),
  `PERSONA_CONTACTO` Varchar(100) NOT NULL,
  `CARGO_PERSONA_CONTACTO` Varchar(200),
  `EMAIL` Varchar(100) NOT NULL,
  `TELEFONO` Varchar(20) NOT NULL,
  `NUM_EMPLEADOS` Int,
  `SECTOR_ACTIVIDAD` Int,
  `URL_WEB` Varchar(200),
  `DESCRIPCION_ACTIVIDAD` Varchar(1000) NOT NULL,
  `UBICACION_CENTRO_TRABAJO` Varchar(200),
  `REPRESENTANTE_LEGAL` Varchar(200),
  `CARGO_REPRESENTANTE` Varchar(200),
  `FECHA_ESCRITURA` Date,
  `NOTARIO` Varchar(200),
  `LOCALIDAD_NOTARIO` Varchar(20),
  `DIRECCION` Varchar(200) NOT NULL,
  `MUNICIPIO` Varchar(200) NOT NULL,
  `PROVINCIA` Varchar(20) NOT NULL,
  `COD_POSTAL` Varchar(10) NOT NULL,
  `PAIS` Int NOT NULL,
  `PERSONA_CONTACTO_CONTABILIDAD` Varchar(200),
  `EMAIL_CONTABILIDAD` Varchar(200),
  `TELEFONO_CONTABILIDAD` Varchar(20),
  `MESES_FACTURA` Int,
  `ALUMNOS_FACTURA` Int,
  PRIMARY KEY (`ID_EMPRESA`)
)
;

-- Table SEDES_EMPRESAS

CREATE TABLE `SEDES_EMPRESAS`
(
  `ID_SEDE_EMPRESA` Int NOT NULL AUTO_INCREMENT,
  `ID_EMPRESA` Int NOT NULL,
  PRIMARY KEY (`ID_SEDE_EMPRESA`)
)
;

-- Table PRACTICAS

CREATE TABLE `PRACTICAS`
(
  `ID_PRACTICA` Int NOT NULL AUTO_INCREMENT,
  PRIMARY KEY (`ID_PRACTICA`)
)
;

-- Table OFERTAS

CREATE TABLE `OFERTAS`
(
  `ID_OFERTA` Int NOT NULL AUTO_INCREMENT,
  `NOMBRE` Varchar(200) NOT NULL,
  `DESCRIPCION` Varchar(20) NOT NULL,
  `DURACION` Int NOT NULL,
  `FECHA_INICIO` Date NOT NULL,
  `FECHA_FIN` Date NOT NULL,
  `INICIO_PLAZO` Date NOT NULL,
  `FIN_PLAZO` Date NOT NULL,
  PRIMARY KEY (`ID_OFERTA`)
)
;

-- Table ESTUDIANTES

CREATE TABLE `ESTUDIANTES`
(
  `ID_ESTUDIANTE` Int NOT NULL AUTO_INCREMENT,
  `NOMBRE` Varchar(200) NOT NULL,
  `APELLIDO1` Varchar(200) NOT NULL,
  `APELLIDO2` Varchar(200),
  `SEXO` Int,
  `FECHA_NACIMIENTO` Date NOT NULL,
  `DNI_NIE` Varchar(20) NOT NULL,
  `TIPO_DOCUMENTO` Int NOT NULL,
  `EMAIL` Varchar(200) NOT NULL,
  `TELEFONO` Varchar(10) NOT NULL,
  `DIRECCION` Varchar(200) NOT NULL,
  `MUNCIPIO` Varchar(200) NOT NULL,
  `PROVINCIA` Varchar(20) NOT NULL,
  `COD_POSTAL` Varchar(20) NOT NULL,
  `PAIS` Int NOT NULL,
  `NACIONALIDAD` Varchar(200) NOT NULL,
  `GRADO_MINUSVALIA` Int,
  `TITULACION_UPM` Int NOT NULL,
  `FECHA_INICIO` Date NOT NULL,
  `FECHA_FIN` Date NOT NULL,
  PRIMARY KEY (`ID_ESTUDIANTE`)
)
;

-- Table CANDIDATURAS

CREATE TABLE `CANDIDATURAS`
(
  `ID_OFERTA` Int NOT NULL,
  `ID_ESTUDIANTE` Int NOT NULL
)
;

ALTER TABLE `CANDIDATURAS` ADD PRIMARY KEY (`ID_OFERTA`,`ID_ESTUDIANTE`)
;

-- Table CURRICULUMS

CREATE TABLE `CURRICULUMS`
(
  `ID_CURRICULUM` Int NOT NULL AUTO_INCREMENT,
  `ID_ESTUDIANTE` Int,
  PRIMARY KEY (`ID_CURRICULUM`)
)
;

-- Table TITULACIONES_UPM

CREATE TABLE `TITULACIONES_UPM`
(
  `ID_TITULACION_UPM` Int NOT NULL AUTO_INCREMENT,
  PRIMARY KEY (`ID_TITULACION_UPM`)
)
;

-- Table TITULACIONES_OTROS

CREATE TABLE `TITULACIONES_OTROS`
(
  `ID_TITULACION` Int NOT NULL AUTO_INCREMENT,
  PRIMARY KEY (`ID_TITULACION`)
)
;

-- Table TRABAJOS

CREATE TABLE `TRABAJOS`
(
  `ID_TRABAJO` Int NOT NULL AUTO_INCREMENT,
  PRIMARY KEY (`ID_TRABAJO`)
)
;

-- Table DATOS_ACADEMICOS_UPM

CREATE TABLE `DATOS_ACADEMICOS_UPM`
(
  `ID_TITULACION_UPM` Int NOT NULL,
  `ID_CURRICULUM` Int NOT NULL
)
;

ALTER TABLE `DATOS_ACADEMICOS_UPM` ADD PRIMARY KEY (`ID_TITULACION_UPM`,`ID_CURRICULUM`)
;

-- Table DATOS_ACADEMICOS_OTROS

CREATE TABLE `DATOS_ACADEMICOS_OTROS`
(
  `ID_TITULACION` Int NOT NULL,
  `ID_CURRICULUM` Int NOT NULL
)
;

ALTER TABLE `DATOS_ACADEMICOS_OTROS` ADD PRIMARY KEY (`ID_TITULACION`,`ID_CURRICULUM`)
;

-- Table EXPERIENCIA_PROFESIONAL

CREATE TABLE `EXPERIENCIA_PROFESIONAL`
(
  `ID_CURRICULUM` Int NOT NULL,
  `ID_TRABAJO` Int NOT NULL
)
;

ALTER TABLE `EXPERIENCIA_PROFESIONAL` ADD PRIMARY KEY (`ID_CURRICULUM`,`ID_TRABAJO`)
;

-- Table DOCUMENTOS

CREATE TABLE `DOCUMENTOS`
(
  `ID_DOCUMENTO` Int NOT NULL AUTO_INCREMENT,
  `ID_CURRICULUM` Int,
  PRIMARY KEY (`ID_DOCUMENTO`)
)
;

-- Table FICHEROS

CREATE TABLE `FICHEROS`
(
  `ID_FICHERO` Int NOT NULL AUTO_INCREMENT,
  `ID_DOCUMENTO` Int,
  PRIMARY KEY (`ID_FICHERO`)
)
;

-- Table CONSTANTES

CREATE TABLE `CONSTANTES`
(
  `ID_CONSTANTE` Int NOT NULL,
  `FAMILIA` Longtext,
  `ATRIBUTO` Longtext,
  `LITERAL` Longtext,
  `VALOR` Int,
  `ACTIVA` Longtext
)
;

ALTER TABLE `CONSTANTES` ADD PRIMARY KEY (`ID_CONSTANTE`)
;

-- Table USUARIOS

CREATE TABLE `USUARIOS`
(
  `ID_USUARIO` Int NOT NULL,
  `LOGIN` Longtext NOT NULL,
  `PASSWORD` Longtext NOT NULL,
  `NOMBRE` Longtext NOT NULL,
  `APELLIDO1` Longtext NOT NULL,
  `APELLIDO2` Longtext,
  `CAMBIAR_PASSWORD` Longtext
)
;

ALTER TABLE `USUARIOS` ADD PRIMARY KEY (`ID_USUARIO`)
;

-- Table ROLES

CREATE TABLE `ROLES`
(
  `ID_ROL` Int NOT NULL,
  `NOMBRE_ROL` Longtext
)
;

ALTER TABLE `ROLES` ADD PRIMARY KEY (`ID_ROL`)
;

-- Table Entity1

CREATE TABLE `Entity1`
(
  `ID_USUARIO` Int NOT NULL,
  `ID_ROL` Int NOT NULL
)
;

ALTER TABLE `Entity1` ADD PRIMARY KEY (`ID_USUARIO`,`ID_ROL`)
;

-- Table REQUISITOS

CREATE TABLE `REQUISITOS`
(
  `ID_REQUISITO` Int NOT NULL,
  `TIPO` Int NOT NULL,
  `PONDERACION` Char(20),
  `CUMPLIMIENTO` Int NOT NULL
)
;

ALTER TABLE `REQUISITOS` ADD PRIMARY KEY (`ID_REQUISITO`)
;

-- Table REQUISITOS_OFERTAS

CREATE TABLE `REQUISITOS_OFERTAS`
(
  `ID_OFERTA` Int NOT NULL,
  `ID_REQUISITO` Int NOT NULL
)
;

ALTER TABLE `REQUISITOS_OFERTAS` ADD PRIMARY KEY (`ID_OFERTA`,`ID_REQUISITO`)
;

-- Create foreign keys (relationships) section ------------------------------------------------- 


ALTER TABLE `SEDES_EMPRESAS` ADD CONSTRAINT `Relationship2` FOREIGN KEY (`ID_EMPRESA`) REFERENCES `EMPRESAS` (`ID_EMPRESA`) ON DELETE RESTRICT ON UPDATE RESTRICT
;


ALTER TABLE `CANDIDATURAS` ADD CONSTRAINT `Relationship3` FOREIGN KEY (`ID_OFERTA`) REFERENCES `OFERTAS` (`ID_OFERTA`) ON DELETE RESTRICT ON UPDATE RESTRICT
;


ALTER TABLE `CANDIDATURAS` ADD CONSTRAINT `Relationship4` FOREIGN KEY (`ID_ESTUDIANTE`) REFERENCES `ESTUDIANTES` (`ID_ESTUDIANTE`) ON DELETE RESTRICT ON UPDATE RESTRICT
;


ALTER TABLE `CURRICULUMS` ADD CONSTRAINT `Relationship8` FOREIGN KEY (`ID_ESTUDIANTE`) REFERENCES `ESTUDIANTES` (`ID_ESTUDIANTE`) ON DELETE RESTRICT ON UPDATE RESTRICT
;


ALTER TABLE `DATOS_ACADEMICOS_UPM` ADD CONSTRAINT `Relationship9` FOREIGN KEY (`ID_TITULACION_UPM`) REFERENCES `TITULACIONES_UPM` (`ID_TITULACION_UPM`) ON DELETE RESTRICT ON UPDATE RESTRICT
;


ALTER TABLE `DATOS_ACADEMICOS_UPM` ADD CONSTRAINT `Relationship10` FOREIGN KEY (`ID_CURRICULUM`) REFERENCES `CURRICULUMS` (`ID_CURRICULUM`) ON DELETE RESTRICT ON UPDATE RESTRICT
;


ALTER TABLE `DATOS_ACADEMICOS_OTROS` ADD CONSTRAINT `Relationship11` FOREIGN KEY (`ID_TITULACION`) REFERENCES `TITULACIONES_OTROS` (`ID_TITULACION`) ON DELETE RESTRICT ON UPDATE RESTRICT
;


ALTER TABLE `DATOS_ACADEMICOS_OTROS` ADD CONSTRAINT `Relationship12` FOREIGN KEY (`ID_CURRICULUM`) REFERENCES `CURRICULUMS` (`ID_CURRICULUM`) ON DELETE RESTRICT ON UPDATE RESTRICT
;


ALTER TABLE `EXPERIENCIA_PROFESIONAL` ADD CONSTRAINT `Relationship13` FOREIGN KEY (`ID_CURRICULUM`) REFERENCES `CURRICULUMS` (`ID_CURRICULUM`) ON DELETE RESTRICT ON UPDATE RESTRICT
;


ALTER TABLE `EXPERIENCIA_PROFESIONAL` ADD CONSTRAINT `Relationship14` FOREIGN KEY (`ID_TRABAJO`) REFERENCES `TRABAJOS` (`ID_TRABAJO`) ON DELETE RESTRICT ON UPDATE RESTRICT
;


ALTER TABLE `DOCUMENTOS` ADD CONSTRAINT `Relationship15` FOREIGN KEY (`ID_CURRICULUM`) REFERENCES `CURRICULUMS` (`ID_CURRICULUM`) ON DELETE RESTRICT ON UPDATE RESTRICT
;


ALTER TABLE `FICHEROS` ADD CONSTRAINT `Relationship16` FOREIGN KEY (`ID_DOCUMENTO`) REFERENCES `DOCUMENTOS` (`ID_DOCUMENTO`) ON DELETE RESTRICT ON UPDATE RESTRICT
;


ALTER TABLE `Entity1` ADD CONSTRAINT `Relationship17` FOREIGN KEY (`ID_USUARIO`) REFERENCES `USUARIOS` (`ID_USUARIO`) ON DELETE RESTRICT ON UPDATE RESTRICT
;


ALTER TABLE `Entity1` ADD CONSTRAINT `Relationship18` FOREIGN KEY (`ID_ROL`) REFERENCES `ROLES` (`ID_ROL`) ON DELETE RESTRICT ON UPDATE RESTRICT
;


ALTER TABLE `REQUISITOS_OFERTAS` ADD CONSTRAINT `Relationship19` FOREIGN KEY (`ID_OFERTA`) REFERENCES `OFERTAS` (`ID_OFERTA`) ON DELETE RESTRICT ON UPDATE RESTRICT
;


ALTER TABLE `REQUISITOS_OFERTAS` ADD CONSTRAINT `Relationship20` FOREIGN KEY (`ID_REQUISITO`) REFERENCES `REQUISITOS` (`ID_REQUISITO`) ON DELETE RESTRICT ON UPDATE RESTRICT
;


